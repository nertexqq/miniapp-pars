# –ó–∞–ø—É—Å–∫ Mini App —Å–µ—Ä–≤–µ—Ä–∞ - –ë—ã—Å—Ç—Ä–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

–¢–µ–ø–µ—Ä—å miniapp –∏–º–µ–µ—Ç **–ø–æ–ª–Ω—ã–π —Ä–∞–±–æ—á–∏–π —Å–µ—Ä–≤–µ—Ä** —Å –ø–∞—Ä—Å–∏–Ω–≥–æ–º –ø–æ–¥–∞—Ä–∫–æ–≤:

- ‚úÖ Flask —Å–µ—Ä–≤–µ—Ä –Ω–∞ –ø–æ—Ä—Ç—É **5001**
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è **–≤—Å–µ—Ö 4 –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤** (Portals, Tonnel, MRKT, GetGems)
- ‚úÖ WebSocket –¥–ª—è —Ä–µ–∞–ª-—Ç–∞–π–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- ‚úÖ API endpoints –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ü–µ–Ω (floor prices)

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –õ–æ–∫–∞–ª—å–Ω–æ (Windows)

```bash
# –î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫ –ø–æ —Ñ–∞–π–ª—É:
run_miniapp.bat

# –ò–ª–∏ –≤ PowerShell/CMD:
cd miniapp
python server.py
```

–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä: **http://localhost:5001**

### –ß–µ—Ä–µ–∑ ngrok (–¥–ª—è —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∏–ª–∏ Telegram)

```powershell
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ ngrok (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
# https://ngrok.com/download

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä –≤ –æ–¥–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
cd miniapp
python server.py

# –í –Ω–æ–≤–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
ngrok http 5001

# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ URL (–Ω–∞–ø—Ä–∏–º–µ—Ä: https://abc123.ngrok-free.app)
# –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ —ç—Ç—É —Å—Å—ã–ª–∫—É
```

## üì° API –ø—Ä–∏–º–µ—Ä—ã

### 1. –í–∫–ª—é—á–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```powershell
$body = @{enabled=$true} | ConvertTo-Json
Invoke-WebRequest -Uri "http://localhost:5001/api/toggle" -Method POST -ContentType "application/json" -Body $body
```

### 2. –í—ã–±—Ä–∞—Ç—å –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å—ã –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã

```powershell
$filters = @{
    marketplaces = @("portals", "tonnel")
    collections = @()
    models = @()
    min_price = 0
    max_price = 100
} | ConvertTo-Json

Invoke-WebRequest -Uri "http://localhost:5001/api/filters" -Method POST -ContentType "application/json" -Body $filters
```

### 3. –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –ø–æ–¥–∞—Ä–∫–∏ (JSON)

```powershell
Invoke-WebRequest -Uri "http://localhost:5001/api/gifts" | Select-Object -ExpandProperty Content | ConvertFrom-Json | Format-Table
```

### 4. –ü–æ–ª—É—á–∏—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫–∏ –∫–æ–ª–ª–µ–∫—Ü–∏–π

```powershell
Invoke-WebRequest -Uri "http://localhost:5001/api/suggestions?type=collection"
```

## üì± –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä miniapp –Ω–∞ ngrok –∏–ª–∏ —Å–≤–æ—ë–º —Å–µ—Ä–≤–µ—Ä–µ
2. URL: `https://abc123.ngrok-free.app`
3. –°–∫–∞–∂–∏—Ç–µ –±–æ—Ç—É –æ—Ç–∫—Ä—ã—Ç—å Mini App

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env)

–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ –∫–æ—Ä–Ω–µ–≤–æ–≥–æ `.env`:

```env
PORTALS_AUTH=tma ...        # –î–ª—è Portals API
TONNEL_AUTH=user=%7B...     # –î–ª—è Tonnel API
MRKT_AUTH=...               # –î–ª—è MRKT API  
GETGEMS_API_KEY=...         # –î–ª—è GetGems API
CHECK_INTERVAL=60           # –ö–∞–∫ —á–∞—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å (—Å–µ–∫)
```

## üìä –†–µ–∞–ª-—Ç–∞–π–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (WebSocket)

–§—Ä–æ–Ω—Ç–µ–Ω–¥ (app.js) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ü–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ WebSocket —Å–µ—Ä–≤–µ—Ä—É
- –ü–æ–ª—É—á–∞–µ—Ç –Ω–æ–≤—ã–µ –ø–æ–¥–∞—Ä–∫–∏ –≤ —Ä–µ–∞–ª-—Ç–∞–π–º
- –û–±–Ω–æ–≤–ª—è–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –ª–æ—Ç–æ–≤

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
miniapp/
‚îú‚îÄ‚îÄ server.py       ‚Üê Flask —Å–µ—Ä–≤–µ—Ä (–≠–¢–û –ù–û–í–û–ï!)
‚îú‚îÄ‚îÄ app.js          ‚Üê –§—Ä–æ–Ω—Ç–µ–Ω–¥ –ª–æ–≥–∏–∫–∞
‚îú‚îÄ‚îÄ index.html      ‚Üê –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞
‚îú‚îÄ‚îÄ style.css       ‚Üê –°—Ç–∏–ª–∏
‚îî‚îÄ‚îÄ README.md       ‚Üê –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üêõ –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

| –ü—Ä–æ–±–ª–µ–º–∞ | –†–µ—à–µ–Ω–∏–µ |
|----------|---------|
| "Port 5001 already in use" | –ò–∑–º–µ–Ω–∏—Ç–µ `port=5001` –Ω–∞ –¥—Ä—É–≥–æ–π –≤ server.py –∏–ª–∏ –∫–∏–ª–Ω–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å |
| WebSocket –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ CORS: `curl -i http://localhost:5001` |
| –ü–æ–¥–∞—Ä–∫–∏ –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è | 1. –í–∫–ª—é—á–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (`/api/toggle`), 2. –í—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å—ã (`/api/filters`), 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `CHECK_INTERVAL` –≤ `.env` |
| "No module named 'flask'" | `pip install -r requirements.txt` |

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä: `python miniapp/server.py`
2. ‚úÖ –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä: `http://localhost:5001`
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
4. ‚úÖ –í–∫–ª—é—á–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ –∏–ª–∏ API
5. ‚úÖ –í—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å—ã (Portals, Tonnel, MRKT, GetGems)
6. ‚úÖ –°–º–æ—Ç—Ä–∏—Ç–µ –ø–æ–¥–∞—Ä–∫–∏ –ø–æ—è–≤–ª—è—Ç—å—Å—è –≤ —Ä–µ–∞–ª-—Ç–∞–π–º–µ!

## üíæ –õ–æ–≥–∏ –∏ –æ—Ç–ª–∞–¥–∫–∞

–ö–æ–≥–¥–∞ –∑–∞–ø—É—â–µ–Ω —Å–µ—Ä–≤–µ—Ä, —Å–º–æ—Ç—Ä–∏—Ç–µ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –ª–æ–≥–æ–≤:
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è: `Client connected: ...`
- –û–±–Ω–æ–≤–ª–µ–Ω–∏—è: `Monitoring loop started`
- –û—à–∏–±–∫–∏: –±—É–¥—É—Ç –≤—ã–≤–µ–¥–µ–Ω—ã –≤ –∫–æ–Ω—Å–æ–ª—å

## üìù –§–∞–π–ª—ã

- **miniapp/server.py** - –ù–æ–≤—ã–π Flask —Å–µ—Ä–≤–µ—Ä (–ø–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–æ–≤)
- **miniapp/app.js** - –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (–Ω–µ –∏–∑–º–µ–Ω—è–ª—Å—è)
- **MINIAPP_SETUP.md** - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **run_miniapp.bat** - –ë–∞—Ç–Ω–∏–∫ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

**–í—Å—ë –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üéâ
